matrix:
  include:
  - os: linux
    dist: trusty
    sudo: required

language: c++
before_install:
#  - if [ "$TRAVIS_EVENT_TYPE" != "pull_request" ]; then openssl aes-256-cbc -K $encrypted_8b763c087de9_key -iv $encrypted_8b763c087de9_iv -in pxscene-build.pem.enc -out /tmp/pxscene-build.pem -d; fi
#  - if [ "$TRAVIS_EVENT_TYPE" != "pull_request" ]; then  eval "$(ssh-agent -s)"; fi
#  - if [ "$TRAVIS_EVENT_TYPE" != "pull_request" ]; then  chmod 0600 /tmp/pxscene-build.pem; fi
#  - if [ "$TRAVIS_EVENT_TYPE" != "pull_request" ]; then  ssh-add /tmp/pxscene-build.pem; fi
  - if [ "$TRAVIS_EVENT_TYPE" = "cron" ]; then ./ci/auto_merge_coverity.sh; fi
  - ./ci/before_install.sh
#  - if [ "$TRAVIS_EVENT_TYPE" != "cron" ] && {[ "$TRAVIS_EVENT_TYPE" = "push" ] || [ "$TRAVIS_EVENT_TYPE" = "pull_request" ]}; then export PATH=/usr/local/opt/ccache/libexec:$PATH; fi
# NOTE THAT COVERITY IS COMPATIBLE WITH gcc 7; upload to coverity fails when using gcc 6 
#  - if [ "$TRAVIS_EVENT_TYPE" != "cron" ] && [ "$TRAVIS_OS_NAME" = "linux" ]; then  export CC=/usr/bin/gcc-6; export CXX=/usr/bin/g++-6 ; sudo ln -s /usr/bin/gcc-6 /usr/local/bin/gcc ; sudo ln -s /usr/bin/g++-6 /usr/local/bin/g++ ; fi
  - if [ "$TRAVIS_EVENT_TYPE" != "cron" ] && {[ "$TRAVIS_EVENT_TYPE" = "push" ] || [ "$TRAVIS_EVENT_TYPE" = "pull_request" ]}; then echo -n | openssl s_client -connect scan.coverity.com:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' | sudo tee -a /etc/ssl/certs/ca-; fi
#  - gcc -v && g++ -v 


install:
  - if [ "$TRAVIS_EVENT_TYPE" != "cron" ]; then ./ci/install.sh; fi
before_script:
  - if [ "$TRAVIS_EVENT_TYPE" != "cron" ]; then ./ci/before_script.sh; fi
script:
  - if [ "$TRAVIS_EVENT_TYPE" != "cron" ]; then ./ci/clean_coverity.sh; fi

addons:
  coverity_scan:
    project:
      name: "conniefry/pxCore"
      description: "Build submitted via Travis CI"
    notification_email: constance_fry@cable.comcast.com
    build_command_prepend: "echo build prepend"
    build_command:   "./ci/make_coverity.sh"
    branch_pattern: coverity_scan_2
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - gcc-6
    - g++-6

env:
  global:
   # The next declaration is the encrypted COVERITY_SCAN_TOKEN, created
   #   via the "travis encrypt" command using the project repo's public key
   - secure: "lZK26VSpJf/OI5N3J2guHKQlp7p7iMHq5tRMD6izblNXGl9QZeDiNBOES/5avxTUjCynjKb++cO+/XNYLr9Wrd3pceD4aaB/iVjIA/1vhgCkKBdXCKA6MrWrOGOVGXH1CbrOg1gmid51iBK3glaHNsfPaZt9t7qYi5IR4Xkcrn5YBoIhWlLOMt4x6htWOnWL+0jXi3k+RTJPomm9OoxLMRPWQ/Gr+6VgzoTJGyfF5ZixhkKbsonO4FK3nrlem7QXLUQYF7yDPZ7KZbMr9h43Zll77IOhoEV7PHDVN1Lz2IHNg4kDfbEH79Tsk43mWZH7MHx2rvKbS0Rg2jHkHZInulm3qLhckJkd93Ct9SfkO4wlpOI93kzZ6ENdm6XzF4c0/cM9M9Uhn+COMpe/S2xsvSbWGtC2r3itjQSAu3mkfYtKnpJkQI32+By/vNKCKMQgleoWqx2w8pVdIneIvoHYr5fQbKA1Tfqbzexd4pO2408z8W3OdSrmztpLPOR15KNN7lM91qAZgDIRP714j0BZG0nXDo2u9JDLLAZrqFioiPaFIFlmEFJ422Z42N8oZoUh/Bl8U/SF1mNgnaPlb7e5tI2fAwrR6+tR2zrcb8NBDuXgqYqzPdLCnVHIX/cHdwvJ0176q/qdPQptNwEaQBGgm8pFSth4AFSGGjKDo5C4TCA="


