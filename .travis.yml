matrix:
  include:
  - os: linux
    dist: trusty
    sudo: required

language: c++
before_install:
#  - if [ "$TRAVIS_EVENT_TYPE" != "pull_request" ]; then openssl aes-256-cbc -K $encrypted_8b763c087de9_key -iv $encrypted_8b763c087de9_iv -in pxscene-build.pem.enc -out /tmp/pxscene-build.pem -d; fi
#  - if [ "$TRAVIS_EVENT_TYPE" != "pull_request" ]; then  eval "$(ssh-agent -s)"; fi
#  - if [ "$TRAVIS_EVENT_TYPE" != "pull_request" ]; then  chmod 0600 /tmp/pxscene-build.pem; fi
#  - if [ "$TRAVIS_EVENT_TYPE" != "pull_request" ]; then  ssh-add /tmp/pxscene-build.pem; fi
  - echo -n | openssl s_client -connect https://scan.coverity.com:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' | sudo tee -a /etc/ssl/certs/ca-
  - ./ci/before_install.sh
#  - if [ "$TRAVIS_EVENT_TYPE" != "cron" ] && {[ "$TRAVIS_EVENT_TYPE" = "push" ] || [ "$TRAVIS_EVENT_TYPE" = "pull_request" ]}; then export PATH=/usr/local/opt/ccache/libexec:$PATH; fi
# NOTE THAT COVERITY IS COMPATIBLE WITH gcc 7; upload to coverity fails when using gcc 6 
#  - if [ "$TRAVIS_EVENT_TYPE" != "cron" ] && [ "$TRAVIS_OS_NAME" = "linux" ]; then  export CC=/usr/bin/gcc-6; export CXX=/usr/bin/g++-6 ; sudo ln -s /usr/bin/gcc-6 /usr/local/bin/gcc ; sudo ln -s /usr/bin/g++-6 /usr/local/bin/g++ ; fi
#  - echo -n | openssl s_client -connect https://scan.coverity.com:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' | sudo tee -a /etc/ssl/certs/ca-
#  - gcc -v && g++ -v 


install:
  - if [ "$TRAVIS_EVENT_TYPE" != "cron" ]; then ./ci/install.sh; fi
before_script:
  - if [ "$TRAVIS_EVENT_TYPE" != "cron" ]; then ./ci/before_script.sh; fi
script:
  - if [ "$TRAVIS_EVENT_TYPE" != "cron" ]; then ./ci/clean_coverity.sh; fi

addons:
  coverity_scan:
    project:
      name: "conniefry/pxCore"
      description: "Build submitted via Travis CI"
    notification_email: constance_fry@cable.comcast.com
    build_command_prepend: "echo build prepend"
    build_command:   "./ci/make_coverity.sh"
    branch_pattern: coverity_scan_2
#  apt:
#    sources:
#    - ubuntu-toolchain-r-test
#    packages:
#    - gcc-6
#    - g++-6

env:
  global:
   # The next declaration is the encrypted COVERITY_SCAN_TOKEN, created
   #   via the "travis encrypt" command using the project repo's public key
   - secure: "NFbpBVLr4RGPTDCMzPKDuAiUfQuPprHQhk86AUsDVvIvK+8dAxvWsYXclCm584e+VLsKqHg659oMQQs1xG6XnWTWTpOboxyRO1msGUn6t/tQC9pQJeaiZUVJrOR2lnoU/sEzLa576638eyNjspEBvpkaHvwYvN/NYwxsANxcwkmRDw0aJSeKfit1tRxgD9mOTvpQWNmiwYWbbwbLd5/c3eddffC4ueSFDvQoNyQR5xQt0q3NCjn0O0ynMyzH0G46ZuB1W7zX/EJQR6i2uWjLHrKXgrjLNDezm11xNYq9hIOwtHMZMzjD3lF5if3YT5x0MUktAOwLs/4hvmX4zIl8ga8d+hICP0OqNzo8VeR6RlYQLhEfwm4PX7xLvc8hUn3sFjhEycqx5l+OCi4Zim+CzF8oeuUbwONwWmkzyr6Ia/05FnJKAwcUwoNtaeN45T1A4s8z68alExvx0isdpm/LGQhlgGcjsQ8H7zwU34BQPCFd6413mLv4ZhOwBG51++NdoWLnfGWbEx+maZonuIOK/1bwMbdCBQQkqMuuwvNc5Lls9fQHa5Ut5N2HjkziGZ2BgqN0orL5ILm5QFAXd4O/9WguqKtJGun1D/mOnrukBoVWvflId7gz7acCWwNH5JKggmA0+S1hV6Ix13zxNNYGj8d/H5bHA1KUBZc62A6p1Ck="


